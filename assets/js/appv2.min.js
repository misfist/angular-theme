var app=angular.module("app",["ngRoute","ngSanitize"]);app.config(function(e,t){t.html5Mode(!0),e.when("/",{templateUrl:ngThemeViews.partials+"main.html",controller:"Main",title:"Home"}).when("/about",{templateUrl:ngThemeViews.partials+"about.html",controller:"Page",title:"About"}).when("/:slug",{templateUrl:ngThemeViews.partials+"post.html",controller:"Post",title:""}).when("/page/:page",{templateUrl:ngThemeViews.partials+"main.html",controller:"Paged",title:"Home"}).when("/category/:category",{templateUrl:ngThemeViews.partials+"main.html",controller:"Category",title:"Category"}).when("/category/:category/page/:page",{templateUrl:ngThemeViews.partials+"main.html",controller:"Category",title:"Category"}).otherwise({redirectTo:"/"})}),app.controller("Main",["$scope","$http","WPService",function(e,t,a){console.log("Main loaded"),e.posts=[],t.get("wp-json/").success(function(t){e.site=t}),t.get("wp-json/wp/v2/posts/").success(function(t,a,o){e.posts=t,e.pageTitle="Latest Posts",e.currentPage=1,e.totalPages=o("X-WP-TotalPages"),console.log("posts",t)}),t.get("wp-json/wp/v2/terms/category/").success(function(t){e.categories=t})}]),app.controller("Page",function(e,t,a){console.log("Page is loaded."),t.get("wp-json/wp/v2/pages/?filter[name]=about").success(function(t){e.post=t[0]})}),app.controller("Post",function(e,t,a){console.log("Post is loaded."),t.get("wp-json/wp/v2/posts/?filter[name]="+a.slug).success(function(a){e.post=a[0],e.post.featured_image>0&&t.get("wp-json/wp/v2/media/"+e.post.featured_image).success(function(t){e.post.image=t,console.log("image",t)})})}),app.controller("Category",function(e,t,a){console.log("Category is loaded."),t.get("wp-json/wp/v2/terms/category/").success(function(t){e.categories=t}),t.get("wp-json/wp/v2/terms/category/"+a.category).success(function(o){e.category=o,e.currentCategoryId=o.id;var s=a.page?parseInt(a.page):1;e.pageTitle="Posts in "+o.name+" Page "+s;var r="wp-json/wp/v2/posts/?filter[category_name]="+o.slug;a.page&&(r+="&page="+a.page),t.get(r).success(function(t,a,o){e.posts=t,e.currentPage=s,e.totalPages=o("X-WP-TotalPages")})})}),app.controller("Paged",function(e,t,a){console.log("Paged is loaded."),t.get("wp-json/wp/v2/terms/category/").success(function(t){e.categories=t}),t.get("wp-json/wp/v2/posts/?page="+a.page).success(function(t,o,s){var r=parseInt(a.page);e.currentPage=r,e.totalPages=s("X-WP-TotalPages"),e.posts=t,e.pageTitle="Posts on page "+e.currentPage,console.log("posts",t)})}),app.directive("searchForm",function(){return{restrict:"EA",templateUrl:ngThemeViews.partials+"search-form.html",controller:function(e,t){e.filter={s:""},e.search=function(){e.filter.s.length>=5&&t.get("wp-json/wp/v2/posts/?filter[s]="+e.filter.s+"&filter[posts_per_page]=-1").success(function(t){e.posts=t,e.currentPage=1,e.totalPages=1})}}}}),app.directive("sidebar",function(){return{restrict:"EA",templateUrl:ngThemeViews.partials+"sidebar.html"}}),app.directive("navigation",function(){return{restrict:"EA",templateUrl:ngThemeViews.partials+"navigation.html"}}),app.directive("postsNavLink",function(){return{restrict:"EA",templateUrl:ngThemeViews.partials+"posts-nav-link.html",controller:["$scope","$element","$routeParams",function(e,t,a){var o=a.page?parseInt(a.page):1,s=a.category?""+a.category+"/page/":"page/";e.postsNavLink={prevLink:s+(o-1),nextLink:s+(o+1),sep:t.attr("sep")?t.attr("sep"):"|",prevLabel:t.attr("prev-label")?t.attr("prev-label"):"Previous Page",nextLabel:t.attr("next-label")?t.attr("next-label"):"Next Page"},console.log("currentPage",o)}]}});